<!DOCTYPE html>
<html lang="zh-HK">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>iOS PWA æ¸¬è©¦</title>

<!-- iOS PWA å¿…é ˆ -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<style>
body { font-family: sans-serif; padding: 20px; }
.ok { color: green; }
.warn { color: red; }
</style>
</head>
<body>
<h1>ğŸ“± iOS PWA æ¸¬è©¦ (test3a_ios_v2.html)</h1>
<div id="status"></div>
<div id="ua"></div>

<script>
(function() {
const isIOS = /iPhone|iPad|iPod/.test(navigator.userAgent);
const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);

// iOS PWA åˆ¤æ–·
const inStandalone = (() => {
// iOS Safari èˆŠæ–¹æ³•
if (window.navigator.standalone) return true;

// ç¾ä»£æ¨™æº–æ–¹æ³•
if (window.matchMedia('(display-mode: standalone)').matches) return true;

// iOS 18+ æ–°ç‰ˆ Safari æœ‰æ™‚å€™ navigator.standalone ä» false
// å˜—è©¦æª¢æŸ¥ window.navigator.userAgent èˆ‡ window.navigator.platform
// ï¼ˆé€™è£¡æš«ç”¨ fallbackï¼Œä¸å½±éŸ¿ä¸€èˆ¬æƒ…æ³ï¼‰
return false;
})();

const statusDiv = document.getElementById('status');
const uaDiv = document.getElementById('ua');

if (isIOS && inStandalone) {
statusDiv.innerHTML = 'âœ… ä½ å·²ä»¥ PWA ä¸»ç•«é¢æ¨¡å¼æ‰“é–‹ï¼';
statusDiv.className = 'ok';
} else if (isIOS && isSafari) {
statusDiv.innerHTML = 'âš ï¸ ä½ ä¿‚ iOS Safariï¼Œä½†ä»²æœªä»¥ PWA ä¸»ç•«é¢æ¨¡å¼æ‰“é–‹ã€‚<br>ğŸ‘‰ è«‹ç”¨ Safari â†’ åˆ†äº« â†’ åŠ åˆ°ä¸»ç•«é¢ï¼Œå†ç”±æ–° icon é–‹å•Ÿã€‚';
statusDiv.className = 'warn';
} else {
statusDiv.innerHTML = 'âš ï¸ ä½ å””ä¿‚ iOS Safariï¼ŒPWA æ¨¡å¼æœªæ¸¬è©¦';
statusDiv.className = 'warn';
}

uaDiv.textContent = navigator.userAgent;
})();
</script>
</body>
</html>