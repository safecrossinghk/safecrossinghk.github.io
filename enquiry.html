<!DOCTYPE html>
<html lang="zh-HK">
<head>
<meta charset="UTF-8">
<title>即時雨量 + 預報 Demo</title>
</head>
<body>
<h2>即時雨量 + 未來兩小時預報</h2>
<button onclick="getRainfall()">查詢我附近雨量</button>
<pre id="result"></pre>

<script>
async function getRainfall() {
if (!navigator.geolocation) {
document.getElementById("result").innerText = "❌ 瀏覽器不支援定位";
return;
}

navigator.geolocation.getCurrentPosition(async pos => {
const lat = pos.coords.latitude.toFixed(3);
const lon = pos.coords.longitude.toFixed(3);

const url = `https://enquiry.ctakwah.workers.dev/?lat=${lat}&lon=${lon}&debug=true`;

const res = await fetch(url);
const data = await res.json();

document.getElementById("result").innerText = JSON.stringify(data, null, 2);
}, err => {
document.getElementById("result").innerText = "❌ 無法取得定位: " + err.message;
});
}
</script>
</body>
</html>