<!DOCTYPE html>
<html lang="zh-HK">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>AI + HKO 雨量預報</title>
<style>
body {
font-family: -apple-system, BlinkMacSystemFont, "PingFang HK", "Microsoft JhengHei", sans-serif;
background: #f7f9fc;
margin: 16px;
font-size: 1.2rem; /* 跟 rainai2a.html 字體一致 */
}
.card {
background: #fff;
padding: 14px;
margin: 10px 0;
border-radius: 8px;
box-shadow: 0 1px 2px rgba(0,0,0,0.08);
}
strong { color: #000; }
</style>
</head>
<body>
<div class="card">AI 預測降雨機率: <strong id="aiProb">--%</strong></div>
<div class="card">AI 預計降雨量: <strong id="aiQpf">0.0 mm</strong></div>
<div class="card">天文台半小時雨量: <strong id="hkoRain">-- mm</strong></div>
<div class="card">天氣狀況: <strong id="weather">--</strong></div>

<script>
async function loadForecast(){
const lat = 22.3027, lon = 114.1772;
try {
const res = await fetch(`https://rainai3.ctakwah.workers.dev/?lat=${lat}&lon=${lon}`);
const data = await res.json();

console.log("Worker 數據:", data);

// --- AI 降雨機率 ---
const aiProb = data.ai?.pop_percent ?? null;
document.getElementById("aiProb").textContent =
(aiProb !== null) ? aiProb + "%" : "--%";

// --- AI 降雨量 ---
const aiQpf = data.ai?.qpf_mm;
document.getElementById("aiQpf").textContent =
(aiQpf !== null && aiQpf !== undefined) ? aiQpf.toFixed(1) + " mm" : "0.0 mm";

// --- HKO 半小時雨量 ---
const hko = data.hko;
if (hko && typeof hko.rain_mm === "number") {
document.getElementById("hkoRain").textContent = hko.rain_mm.toFixed(1) + " mm";
} else {
document.getElementById("hkoRain").textContent = "-- mm";
}

// --- 天氣狀況 ---
document.getElementById("weather").textContent =
(hko && hko.condition) ? hko.condition : "--";

} catch (err) {
console.error("載入失敗", err);
document.getElementById("aiProb").textContent = "錯誤";
document.getElementById("aiQpf").textContent = "錯誤";
document.getElementById("hkoRain").textContent = "錯誤";
document.getElementById("weather").textContent = "錯誤";
}
}
loadForecast();
</script>
</body>
</html>