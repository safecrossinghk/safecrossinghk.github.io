<!DOCTYPE html>
<html lang="zh-HK">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>é¦™æ¸¯å³æ™‚é›¨é‡æ¸¬è©¦ (æ‰‹æ©Ÿç‰ˆ)</title>
<style>
body {
font-family: Arial, sans-serif;
margin: 10px;
padding: 0;
background: #f8f9fa;
}
h2 {
text-align: center;
}
.controls {
display: flex;
flex-direction: column;
gap: 8px;
margin-bottom: 12px;
}
.controls label {
font-size: 1rem;
}
input, button {
font-size: 1rem;
padding: 6px;
}
button {
background: #007bff;
color: white;
border: none;
border-radius: 4px;
}
button:hover {
background: #0056b3;
}
.cards {
display: flex;
flex-wrap: wrap;
gap: 10px;
justify-content: center;
}
.card {
flex: 1 1 150px;
background: white;
border-radius: 8px;
box-shadow: 0 2px 6px rgba(0,0,0,0.1);
padding: 12px;
text-align: center;
}
.card h3 {
margin: 0 0 5px;
font-size: 1.1rem;
}
.card p {
margin: 0;
font-size: 1rem;
}
.table-container {
overflow-x: auto;
margin-top: 15px;
}
table {
border-collapse: collapse;
width: 100%;
font-size: 0.9rem;
}
th, td {
border: 1px solid #ccc;
padding: 6px;
text-align: center;
}
pre {
background: #222;
color: #0f0;
padding: 10px;
border-radius: 6px;
overflow-x: auto;
font-size: 0.85rem;
}
</style>
</head>
<body>
<h2>ğŸŒ§ é¦™æ¸¯å³æ™‚é›¨é‡æ¸¬è©¦</h2>

<div class="controls">
<label>ç·¯åº¦: <input type="text" id="lat" value="22.34"></label>
<label>ç¶“åº¦: <input type="text" id="lon" value="114.182"></label>
<label><input type="checkbox" id="debug"> Debug æ¨¡å¼</label>
<button onclick="checkRain()">æŸ¥è©¢é›¨é‡</button>
</div>

<div class="cards" id="cards"></div>

<div class="table-container">
<table id="rainTable">
<thead>
<tr>
<th>æ™‚æ®µ</th>
<th>é›¨é‡ (mm)</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<h3>Debug JSON è¼¸å‡º</h3>
<pre id="result">ç­‰å¾…æŸ¥è©¢...</pre>

<script>
async function checkRain() {
const lat = document.getElementById("lat").value;
const lon = document.getElementById("lon").value;
const debug = document.getElementById("debug").checked;

const url = `https://safecrossinghk.github.io/rainenquiry.html?lat=${lat}&lon=${lon}${debug ? "&debug=true" : ""}`;

try {
const res = await fetch(url);
const data = await res.json();

// é¡¯ç¤ºå¡ç‰‡
const cards = document.getElementById("cards");
cards.innerHTML = "";
if (data.debugRaw && data.debugRaw.rainSeries) {
Object.entries(data.debugRaw.rainSeries).forEach(([key, val]) => {
const div = document.createElement("div");
div.className = "card";
div.innerHTML = `<h3>${key}</h3><p>${val !== null ? val + " mm" : "â€”"}</p>`;
cards.appendChild(div);
});
} else {
cards.innerHTML = `<div class="card"><h3>å³æ™‚é›¨é‡</h3><p>${data.immediateRain} mm</p></div>`;
}

// è¡¨æ ¼
const tbody = document.querySelector("#rainTable tbody");
tbody.innerHTML = "";
if (data.debugRaw && data.debugRaw.rainSeries) {
Object.entries(data.debugRaw.rainSeries).forEach(([key, val]) => {
const tr = document.createElement("tr");
tr.innerHTML = `<td>${key}</td><td>${val !== null ? val + " mm" : "â€”"}</td>`;
tbody.appendChild(tr);
});
} else {
const tr = document.createElement("tr");
tr.innerHTML = `<td>å³æ™‚</td><td>${data.immediateRain} mm</td>`;
tbody.appendChild(tr);
}

// JSON
document.getElementById("result").textContent = JSON.stringify(data, null, 2);
} catch (err) {
document.getElementById("result").textContent = "âŒ éŒ¯èª¤: " + err.message;
}
}
</script>
</body>
</html>