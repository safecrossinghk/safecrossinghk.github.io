<!DOCTYPE html>
<html lang="zh-HK">
<head>
<meta charset="UTF-8">
<title>未來半小時雨勢預報</title>
<style>
body {
font-family: Arial, sans-serif;
padding: 20px;
background: #f0f0f0;
}
#rainText {
font-size: 20px;
font-weight: bold;
color: #333;
padding: 10px;
background: #fff;
border-radius: 8px;
display: inline-block;
}
</style>
</head>
<body>
<h2>香港地區未來半小時雨勢</h2>
<div id="rainText">正在載入雨勢資料...</div>

<script>
const API_KEY = "Eff94C5FCuRqlqWKPt0tXwHM1niZNEYh"; // 請換成 Tomorrow.io 的 API Key
const LAT = 22.329, LON = 114.144; // 香港座標，可改其他地點

fetch(`https://api.tomorrow.io/v4/weather/forecast?location=${LAT},${LON}&fields=rainIntensity,precipitationProbability&timesteps=1m&units=metric&apikey=${API_KEY}`)
.then(res => res.json())
.then(data => {
const minutes = data.data.timelines.minutely.slice(0, 30); // 取未來 30 分鐘

let maxRain = 0;
let maxProb = 0;

minutes.forEach(m => {
if (m.values.rainIntensity > maxRain) maxRain = m.values.rainIntensity;
if (m.values.precipitationProbability > maxProb) maxProb = m.values.precipitationProbability;
});

let text = `未來半小時：☀️ 無雨（降雨機率 ${maxProb}%）`;
if (maxRain > 0 && maxRain <= 2) text = `未來半小時：🌦 小雨（降雨機率 ${maxProb}%）`;
else if (maxRain > 2 && maxRain <= 6) text = `未來半小時：🌧 中雨（降雨機率 ${maxProb}%）`;
else if (maxRain > 6) text = `未來半小時：⛈ 大雨（降雨機率 ${maxProb}%）`;

document.getElementById("rainText").innerText = text;
})
.catch(err => {
document.getElementById("rainText").innerText = "⚠️ 雨勢資料讀取失敗";
console.error(err);
});
</script>
</body>
</html>